{{- define "patchType" -}}

{{ if and .Patch.Generate (not (or .ReadOnly .Immutable)) }}

// {{.Patch.Name}} can (partially) patch a {{.PackagePrefix}}{{.Type}}.
//
// Endo: (immutable: true).
type {{.Patch.Name}} struct {
{{- range .Patch.Fields true }}
	{{.Name}}	{{.Type}}	`db:"{{.Column}}"`
{{- end}}
}

{{ end }}

{{- end -}}

// Code generated by endogen; DO NOT EDIT.

package {{.Package}}

import (
	{{ range .Imports -}}
	{{.Spec}}
	{{end}})

{{range .Models}}

{{template "patchType" .}}

{{end}}
